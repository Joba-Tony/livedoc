# CYZC Unity 客户端 MVP 快速实施方案

> **文档版本**: v4.0  
> **创建日期**: 2025年12月31日  
> **基于**: cyzc_old 源码完整分析  
> **团队配置**: 2程序 + 1美术 + 1测试  
> **目标**: 18天内交付可玩的MVP版本

---

## 一、当前状态评估

### 1.1 已完成功能（约40%）

| 模块 | 完成度 | 说明 |
|------|--------|------|
| 热更新框架 | 100% | HybridCLR + YooAsset |
| 网络通信层 | 80% | XSocket协议完整 |
| 登录/注册 | 100% | 完整可用 |
| 角色管理 | 100% | 创建/选择/删除 |
| 地图系统 | 90% | PAK加载、Tilemap渲染 |
| 移动系统 | 100% | A*寻路、8方向移动 |
| NPC/怪物渲染 | 90% | 显示正常、移动正常 |
| 聊天系统 | 100% | 多频道完整 |
| 技能快捷栏 | 100% | UI完整、冷却显示 |
| 战斗消息 | 80% | 攻击/魔法消息已有 |

### 1.2 未完成的MVP必需功能

| 模块 | 状态 | 预计工时 | 优先级 |
|------|------|----------|--------|
| NPC交互系统 | 0% | 16h | P0 |
| 背包UI系统 | 0% | 30h | P0 |
| 装备UI系统 | 0% | 17h | P0 |
| 商店系统 | 0% | 18h | P0 |
| 战斗效果完善 | 20% | 28h | P0 |
| **MVP必需总计** | | **109h** | |

### 1.3 可选功能（有时间再做）

| 模块 | 状态 | 预计工时 | 优先级 |
|------|------|----------|--------|
| 仓库系统 | 0% | 20h | P1 |
| 小地图 | 0% | 25h | P1 |
| 角色属性面板 | 0% | 15h | P1 |
| 物品修理 | 0% | 14h | P1 |
| **可选总计** | | **74h** | |

---

## 二、MVP功能范围

### 2.1 必须实现的功能

```
✅ 已完成          ❌ 需开发
───────────────────────────────
✅ 账号登录/注册
✅ 角色创建/选择/删除
✅ 地图显示与移动
✅ 聊天系统
✅ 技能快捷栏
❌ NPC点击交互
❌ NPC对话UI
❌ 背包界面
❌ 物品管理（使用/丢弃）
❌ 物品Tooltip
❌ 装备界面
❌ 装备穿戴/卸下
❌ 商店界面
❌ 购买/出售物品
❌ 战斗效果完善
❌ 死亡/复活处理
❌ 怪物血条
```

### 2.2 MVP不包含的功能

以下功能留到公测版本：
- 任务系统
- 组队系统  
- 公会系统
- 交易/摆摊
- 天使/宠物
- 国战/战场
- 强化/宝石
- 排行榜

---

## 三、开发计划（30天）

### 3.1 时间规划总览

| 阶段 | 内容 | 工期 | 累计 |
|------|------|------|------|
| **Week 1** | NPC交互 + 对话UI | 5天 | 5天 |
| **Week 2** | 背包系统完整 | 5天 | 10天 |
| **Week 3** | 装备系统完整 | 4天 | 14天 |
| **Week 4前** | 商店系统 | 3天 | 17天 |
| **Week 4后** | 战斗效果完善 | 4天 | 21天 |
| **Week 5** | 测试修复 | 5天 | 26天 |
| **缓冲** | 风险预留 | 4天 | **30天** |

### 3.2 Phase 1: NPC交互系统 (Day 1-3)

#### Day 1-2: NPC点击与交互框架（并行开发）

| 任务 | 工时 | 负责人 |
|------|------|--------|
| NPC点击检测完善 | 2h | 程序1 |
| NPCInteractionManager | 6h | 程序1 |
| NPC功能路由 | 4h | 程序2 |
| 对话UI布局设计 | 2h | 美术 |

**NPC类型路由逻辑**:
```
商店NPC → 打开商店面板
仓库NPC → 打开仓库面板 (P1)
魔法师NPC → 打开魔法学习 (后续)
其他NPC → 打开对话面板
```

#### Day 2-3: NPC对话UI（并行开发）

| 任务 | 工时 | 负责人 |
|------|------|--------|
| 对话面板控制器 | 4h | 程序1 |
| 对话选项系统 | 4h | 程序2 |
| NPC头顶名称完善 | 2h | 程序2 |
| 对话网络消息 | 4h | 程序1 |
| 对话UI制作 | 4h | 美术 |

**对话UI布局**:
```
┌─────────────────────────────────┐
│ [头像] NPC名称            [X]  │
├─────────────────────────────────┤
│ "欢迎来到比奇城！"              │
├─────────────────────────────────┤
│ [1] 打开商店                    │
│ [2] 再见                        │
└─────────────────────────────────┘
```

**里程碑M1**: Day 3 - NPC可点击交互

---

### 3.3 Phase 2: 背包系统 (Day 4-6)

#### Day 4-5: 背包UI界面（并行开发）

| 任务 | 工时 | 负责人 |
|------|------|--------|
| 背包UI布局(48格) | 4h | 美术 |
| 背包格子组件 | 4h | 程序1 |
| 物品图标加载 | 3h | 程序1 |
| 背包管理器 | 4h | 程序2 |
| 物品拖拽系统 | 4h | 程序2 |

#### Day 5-6: 物品操作

| 任务 | 工时 | 负责人 |
|------|------|--------|
| 物品使用功能 | 4h | 程序1 |
| 物品丢弃功能 | 3h | 程序2 |
| 背包网络同步 | 4h | 程序1 |
| 物品Tooltip | 6h | 程序2 |
| 物品右键菜单 | 2h | 程序2 |

**里程碑M2**: Day 6 - 背包系统可用

---

### 3.4 Phase 3: 装备系统 (Day 7-8)

#### Day 7-8: 装备系统完整（并行开发）

| 任务 | 工时 | 负责人 |
|------|------|--------|
| 装备栏UI(13槽位) | 4h | 美术 |
| 装备栏控制器 | 4h | 程序1 |
| 装备穿戴逻辑 | 4h | 程序1 |
| 装备卸下逻辑 | 3h | 程序2 |
| 装备属性显示 | 4h | 程序2 |
| 装备网络消息 | 4h | 程序1 |

**装备位置（13个）**:
```
头盔 | 项链 | 披风
武器 | 盔甲 | 盾牌
手套 | 腰带 | 鞋子
戒指1 | 戒指2 | 手镯1 | 手镯2
```

#### Day 13-14: 装备属性与外观

| 任务 | 工时 | 产出 |
|------|------|------|
| 装备属性显示 | 4h | 装备Tooltip |
| 装备外观更新 | 4h | 穿戴后角色外观变化 |
| 装备网络消息 | 4h | 服务端同步 |

**里程碑M3**: Day 14 - 装备系统可用

---

### 3.5 Week 4前半: 商店系统 (Day 15-17)

#### Day 15-16: 商店UI界面

| 任务 | 工时 | 产出 |
|------|------|------|
| 商店UI布局 | 4h | ShopPanel.prefab |
| 商店控制器 | 4h | ShopPanel.cs |
| 商品列表显示 | 4h | 商品图标/价格 |

#### Day 17: 购买出售功能

| 任务 | 工时 | 产出 |
|------|------|------|
| 购买功能 | 4h | 购买逻辑 |
| 出售功能 | 4h | 出售逻辑 |
| 金币显示更新 | 2h | UI更新 |

**里程碑M4**: Day 17 - 商店系统可用

---

### 3.6 Phase 5: 战斗效果完善 (Day 11-12)

#### Day 11-12: 魔法效果与死亡复活（并行开发）

| 任务 | 工时 | 负责人 |
|------|------|--------|
| MagicExecutor完善 | 8h | 程序1 |
| 伤害数字服务器连接 | 4h | 程序2 |
| Buff/Debuff显示 | 4h | 程序1 |
| 怪物血条显示 | 4h | 程序2 |
| 死亡处理 | 4h | 程序1 |
| 复活机制 | 4h | 程序2 |
| 战斗特效 | 4h | 美术 |

**需要实现的魔法效果**:
```
DEF_MAGICTYPE_DAMAGE_SPOT    - 单体伤害
DEF_MAGICTYPE_DAMAGE_AREA    - 范围伤害
DEF_MAGICTYPE_HPUP_SPOT      - 单体治疗
DEF_MAGICTYPE_HPUP_AREA      - 范围治疗
```

**里程碑M5**: Day 12 - 战斗完善

---

### 3.7 Phase 6: 测试与修复 (Day 13-16)

#### Day 13-14: 功能测试（并行执行）

| 任务 | 工时 | 负责人 |
|------|------|--------|
| NPC交互测试 | 4h | 测试 |
| 背包装备测试 | 4h | 测试 |
| 商店交易测试 | 4h | 测试 |
| 战斗流程测试 | 4h | 测试 |
| Bug修复 | 8h | 程序1+2 |

#### Day 15-16: Bug修复与优化

| 任务 | 工时 | 负责人 |
|------|------|--------|
| P0 Bug修复 | 12h | 程序1+2 |
| 流程优化 | 6h | 程序1 |
| UI调整 | 6h | 美术 |

### 3.8 Day 17-18: 缓冲期

预留2天用于：
- 意外问题处理
- 协议调试
- 性能优化
- 最终验收

**里程碑M6**: Day 18 - **MVP交付**

---

## 四、里程碑总览

```
Week 1              Week 2              Week 3
├───────────────────┼───────────────────┼──────────┤
│                   │                   │          │
├─M1 NPC(D3)        ├─M3 装备(D8)       ├─M6 MVP(D18)
├─M2 背包(D6)       ├─M4 商店(D10)      │
│                   ├─M5 战斗(D12)      │
```

| 里程碑 | 时间 | 验收标准 |
|--------|------|----------|
| M1 | Day 3 | 点击NPC弹出对话框 |
| M2 | Day 6 | 背包可用，物品可操作 |
| M3 | Day 8 | 装备可穿戴，外观变化 |
| M4 | Day 10 | 商店可买卖物品 |
| M5 | Day 12 | 战斗流畅，死亡可复活 |
| M6 | Day 18 | **MVP交付** |

---

## 五、技术要点

### 5.1 关键消息协议

| 功能 | 消息类型 | 状态 |
|------|----------|------|
| NPC对话 | DEF_COMMONTYPE_TALKTONPC | 需实现 |
| 物品使用 | DEF_COMMONTYPE_USEITEM | 需实现 |
| 物品丢弃 | DEF_COMMONTYPE_DROPITEM | 需实现 |
| 装备穿戴 | DEF_COMMONTYPE_EQUIPITEM | 需实现 |
| 装备卸下 | DEF_COMMONTYPE_RELEASEITEM | 需实现 |
| 购买物品 | DEF_COMMONTYPE_PURCHASEITEM | 需实现 |
| 出售物品 | DEF_COMMONTYPE_SELLITEM | 需实现 |

### 5.2 需要复用的现有代码

| 模块 | 文件 | 用途 |
|------|------|------|
| 物品数据 | ItemManager.cs | 物品配置管理 |
| 物品定义 | ItemTypes.cs | 物品类型枚举 |
| 魔法配置 | MagicConfig.json | 魔法属性 |
| NPC配置 | NPCConfig.cs | NPC类型定义 |

---

## 六、风险管理

| 风险 | 可能性 | 影响 | 应对措施 |
|------|--------|------|----------|
| 消息协议不匹配 | 高 | 延期3-5天 | 提前抓包验证 |
| UI布局问题 | 中 | 延期2天 | 用占位图先行 |
| 战斗效果复杂 | 中 | 延期2-3天 | 先做基础效果 |
| 网络调试耗时 | 高 | 延期3天 | 预留缓冲期 |

---

## 七、交付成果

### 7.1 MVP可体验流程

```
注册账号 → 登录游戏 → 创建角色 → 进入世界 → 与NPC对话
    → 打怪升级 → 获得掉落 → 管理背包 → 穿戴装备 → 购买药品 → 继续战斗
```

### 7.2 交付物清单

| 交付物 | 说明 |
|--------|------|
| Windows客户端 | 可运行exe |
| 热更新资源包 | 支持后续更新 |
| 功能说明 | 操作指南 |

---

## 八、总结

| 项目 | 内容 |
|------|------|
| **团队配置** | 2程序 + 1美术 + 1测试 |
| **当前进度** | 40% |
| **MVP工时** | 109h（必需） |
| **预计工期** | **18个工作日** |
| **交付时间** | 2025年1月下旬 |
| **后续公测** | 额外需要约35天 |

### 工作分配表

| 角色 | 工作量占比 | 主要产出 |
|------|-----------|----------|
| 程序1 | 50% | 系统架构、核心逻辑 |
| 程序2 | 50% | 功能实现、协议对接 |
| 美术 | 100% | UI界面、图标特效 |
| 测试 | 100% | 测试报告、Bug提交 |

---

> 本方案按固定团队配置（2程序+1美术+1测试）计算，确保18天内交付可玩版本。
