# 荣誉(JJCScore)系统详解

## 一、概述

荣誉系统是游戏中的竞技场/国战排名系统，玩家通过3C竞技场、国战排名等方式获取荣誉值，用于展示玩家的PVP成就。

> ?? **注意区分**：荣誉(`m_sJJCScore`)和贡献度(`m_iContribution`)是两个完全不同的系统！
> - **荣誉**：显示在高级属性面板，用于3C竞技场和国战排名奖励
> - **贡献度**：显示在角色名旁边，影响军衔和战斗属性

**关键代码位置：**
- 变量定义：`HGServer/Client.h` 第290行 (`m_sJJCScore`)
- 修改函数：`HGServer/3Channel.cpp` 第275行 (`ModifyPlayerJJCScore`)
- 显示代码：`HGClient/NotifyMsgHandler.cpp` 第23392行

---

## 二、荣誉获取方式一览表

### ? 完整获取方式

| 方式 | 基础荣誉 | 实际荣誉 | 说明 |
|:----:|:--------:|:--------:|:-----|
| **3C竞技场击杀敌人** | +1 | +1×倍率 | 3C竞技场战斗中击杀敌方玩家 |
| **3F竞技场击杀敌人** | +1 | +1×倍率 | 3F竞技场战斗中击杀敌方玩家 |
| **国战击杀敌人** | +1 | +1×倍率 | 国战模式下击杀敌国玩家 |
| **3C建造防御塔** | +5 | +5×倍率 | 使用50个资源建造防御塔 |
| **3C修复基地塔** | +8 | +8×倍率 | 使用100个资源修复基地塔 |
| **3C摧毁敌方城门(AGT/CGT)** | +5 | +5×倍率 | 摧毁敌方城门 |
| **3C摧毁敌方魔法发动机** | +8 | +8×倍率 | 摧毁敌方核心建筑 |
| **国战摧毁敌方城门(AGT/CGT)** | +5 | +5×倍率 | 国战中摧毁敌方城门 |
| **国战摧毁敌方魔法发动机** | +8 | +8×倍率 | 国战中摧毁敌方核心 |
| **国战参与奖励(胜方)** | +15 | +15×倍率 | 胜利方在线玩家 |
| **国战参与奖励(败方)** | +8 | +8×倍率 | 失败方在线玩家 |
| **完成任务奖励** | 任务配置 | 任务配置 | 特定任务奖励 |
| **荣誉勋章道具** | +5/10/15/20 | 固定值 | ItemID:471-474 |
| 竞技场PK赌注(输) | -赌注 | -赌注 | PK失败扣除 |
| 友军误伤惩罚 | -10 | -10 | 攻击友方核心建筑 |

> **倍率说明**：实际获得荣誉 = 基础荣誉 × `m_i3CRankRatio`（3C竞技场荣誉倍数，服务器配置）

---

## 三、国战排名荣誉奖励

### 3.1 胜利方排名奖励

| 排名 | 荣誉奖励 |
|:----:|:--------:|
| 第1名 | **+12** × 倍率 |
| 第2名 | **+10** × 倍率 |
| 第3名 | **+8** × 倍率 |
| 第4名 | **+7** × 倍率 |
| 第5名 | **+6** × 倍率 |
| 第6名 | **+5** × 倍率 |
| 第7名 | **+4** × 倍率 |

### 3.2 失败方排名奖励

| 排名 | 荣誉奖励 |
|:----:|:--------:|
| 第1名 | **+10** × 倍率 |
| 第2名 | **+8** × 倍率 |
| 第3名 | **+6** × 倍率 |
| 第4名 | **+6** × 倍率 |

---

## 四、3C竞技场荣誉获取详情

### 4.1 战斗中获取

| 行为 | 荣誉 | 代码位置 |
|:----:|:----:|:--------:|
| 击杀敌方玩家 | +1 | [Game.cpp#L21435](HGServer/Game.cpp#L21435) |
| 摧毁敌方城门(AGT/CGT) | +5 | [Game.cpp#L16999](HGServer/Game.cpp#L16999) |
| 摧毁敌方魔法发动机 | +8 | [Game.cpp#L17068](HGServer/Game.cpp#L17068) |

### 4.2 建设中获取

| 行为 | 荣誉 | 代码位置 |
|:----:|:----:|:--------:|
| 建造防御塔(消耗50资源) | +5 | [NewPartySystem.cpp#L2445](HGServer/NewPartySystem.cpp#L2445) |
| 修复基地塔(消耗100资源) | +8 | [NewPartySystem.cpp#L2479](HGServer/NewPartySystem.cpp#L2479) |

### 4.3 3C结算奖励

3C竞技场结束时，根据队伍排名获得荣誉奖励：
- 胜利队伍：每人 +10 × 倍率
- 失败队伍：每人 +6 × 倍率

---

## 五、荣誉扣除情况

| 行为 | 荣誉变化 | 说明 |
|:----:|:--------:|:-----|
| 竞技场PK赌注(输) | -赌注数量 | 以荣誉为赌注PK失败 |
| 攻击友方核心建筑 | **-10** | 误伤友军惩罚 |

---

## 六、相关配置参数

| 参数 | 变量名 | 说明 |
|:----:|:------:|:-----|
| 荣誉上限 | 20000 | 最高可达到的荣誉值 |
| 荣誉倍率 | `m_i3CRankRatio` | 3C竞技场荣誉倍数，影响大部分荣誉获取 |
| 荣誉系统开关 | `m_bGuozhanJJC` | 国战是否有荣誉奖励 |
| 荣誉PK赌注开关 | `m_bJJCScorePK` | PK是否可以用荣誉做赌注 |

---

## 七、荣誉与贡献度对比

| 属性 | 荣誉(JJCScore) | 贡献度(Contribution) |
|:----:|:--------------:|:-------------------:|
| 变量名 | `m_sJJCScore` | `m_iContribution` |
| 显示位置 | **高级属性面板** | **角色名旁边** |
| 上限 | 20000 | 20000 |
| 下限 | 0 | -20000 |
| 主要来源 | 3C竞技场、国战排名 | 击杀敌国玩家、道具 |
| 主要用途 | 排名展示、PK赌注 | 军衔称号、战斗增益 |
| 战斗属性影响 | **无** | **有**（伤害加成/减免） |

---

## 八、注意事项

1. **荣誉** (`m_sJJCScore`) 和 **贡献度** (`m_iContribution`) 是两个完全不同的系统
2. 荣誉值不能为负数，最低为0
3. 大部分荣誉获取都会乘以服务器配置的倍率(`m_i3CRankRatio`)
4. 荣誉系统需要服务器开启才有效(`m_bGuozhanJJC`、`m_serverNewVerData.s69JjcSystemOpened`)
5. 荣誉不影响战斗属性，只用于排名和展示

---

*文档生成时间：2026年1月5日*
*代码版本：基于当前工作区代码分析*
