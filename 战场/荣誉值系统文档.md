# 荣誉值(Contribution)系统详解

## 一、概述

荣誉值系统是游戏中的军衔/职级系统，玩家通过国战、击杀敌方玩家等方式获取荣誉值，达到一定数值后可以获得对应的军衔称号和战斗增益。

**关键代码位置：**
- 职级定义：`HGClient/Game.cpp` 第555-572行
- 职级判断：`HGClient/Game.cpp` 第40337-40353行 (`iGetJJCRankLevel`函数)
- 增益计算：`HGServer/GlobalDef.h` 第22-25行
- 伤害应用：`HGServer/Game.cpp` 多处

---

## 二、职级与所需荣誉值对照表

| 等级 | 职级名称 | 所需荣誉值 | 荣誉值区间 |
|:----:|:--------:|:----------:|:----------:|
| 0 | 列兵 | 0 | 0 ~ 49 |
| 1 | 军士 | 50 | 50 ~ 149 |
| 2 | 军士长 | 150 | 150 ~ 299 |
| 3 | 士官长 | 300 | 300 ~ 499 |
| 4 | 骑士守卫 | 500 | 500 ~ 799 |
| 5 | 骑士队长 | 800 | 800 ~ 1199 |
| 6 | 司令 | 1200 | 1200 ~ 1699 |
| 7 | 统帅 | 1700 | 1700 ~ 2299 |
| 8 | 元帅 | 2300 | 2300 ~ 3199 |
| 9 | 大元帅 | 3200 | 3200 ~ 4999 |
| 10 | 大元帅★ | 5000 | 5000 ~ 9999 |
| 11 | 大元帅★★ | 10000 | 10000 ~ 11999 |
| 12 | 大元帅★★★ | 12000 | 12000 ~ 20000 |

**荣誉值上限：** `DEF_MAX_CONTRIBUTION = 20000`

---

## 三、增益属性详解

### 3.1 物理攻击增益

**计算公式：**
```
额外物理伤害 = 荣誉值 / 4000
```

**示例计算：**
| 荣誉值 | 额外物理伤害 |
|:------:|:------------:|
| 4000 | +1 |
| 8000 | +2 |
| 12000 | +3 |
| 16000 | +4 |
| 20000 | +5 |

### 3.2 魔法攻击增益

**计算公式：**
```
额外魔法伤害 = 荣誉值 / 4000
```

**特殊说明：** 魔法伤害增益有 **25%概率触发**（每次攻击随机判定）

**示例计算：**
| 荣誉值 | 额外魔法伤害(触发时) |
|:------:|:-------------------:|
| 4000 | +1 |
| 8000 | +2 |
| 12000 | +3 |
| 16000 | +4 |
| 20000 | +5 |

### 3.3 对负荣誉值目标的额外伤害

当目标玩家荣誉值为负数时（叛国者/罪犯），攻击者会获得额外伤害加成：

**计算公式：**
```
额外伤害 = |目标荣誉值| / 200
最大额外伤害 = 10
```

**示例计算：**
| 目标荣誉值 | 额外伤害 |
|:----------:|:--------:|
| -200 | +1 |
| -500 | +2 |
| -1000 | +5 |
| -2000及以下 | +10 (上限) |

### 3.4 对高荣誉值目标的伤害减免

当攻击高荣誉值目标时，目标方会获得伤害减免（等于减少攻击者的伤害）：

**计算公式：**
```
伤害减免 = 目标荣誉值 / 4000
```

**示例计算：**
| 目标荣誉值 | 受到伤害减少 |
|:----------:|:------------:|
| 4000 | -1 |
| 8000 | -2 |
| 12000 | -3 |
| 16000 | -4 |
| 20000 | -5 |

---

## 四、各职级增益汇总表

| 职级 | 荣誉值范围 | 物理伤害加成 | 魔法伤害加成(25%概率) | 受到伤害减免 |
|:----:|:----------:|:------------:|:--------------------:|:------------:|
| 列兵 | 0-49 | +0 | +0 | -0 |
| 军士 | 50-149 | +0 | +0 | -0 |
| 军士长 | 150-299 | +0 | +0 | -0 |
| 士官长 | 300-499 | +0 | +0 | -0 |
| 骑士守卫 | 500-799 | +0 | +0 | -0 |
| 骑士队长 | 800-1199 | +0 | +0 | -0 |
| 司令 | 1200-1699 | +0 | +0 | -0 |
| 统帅 | 1700-2299 | +0 | +0 | -0 |
| 元帅 | 2300-3199 | +0 | +0 | -0 |
| 大元帅 | 3200-4999 | +0~1 | +0~1 | -0~1 |
| 大元帅★ | 5000-9999 | +1~2 | +1~2 | -1~2 |
| 大元帅★★ | 10000-11999 | +2 | +2 | -2 |
| 大元帅★★★ | 12000-20000 | +3~5 | +3~5 | -3~5 |

**注意：** 增益是连续的线性增长，职级只是称号显示，实际增益按具体荣誉值计算。

---

## 五、特殊武器增益

以下武器可以**额外享受荣誉值加成**（双重计算）：

### 单手武器
- **KlonessEsterk** (ID: 771)
- **KlonessWand(MS.20)** (ID: 763)
- **KlonessWand(MS.10)** (ID: 764)

### 双手武器
- **KlonessBlade** (ID: 779)
- **ID: 770**

使用这些武器时，荣誉值增益会被**应用两次**：一次在基础属性计算，一次在伤害计算。

---

## 六、国家差异

### 6.1 职级名称

**阿瑞登(Aresden)** 和 **爱芬(Elvine)** 两个国家：
- **职级名称：** 完全相同，无区别
- **职级判定：** 完全相同，无区别

### 6.2 增益计算

**结论：两国完全相同，无任何差异。**

荣誉值系统的增益计算代码中没有对 `m_cSide`（国家）进行区分判断，所有公式和系数对两国玩家完全一致。

---

## 七、荣誉值获取途径

### 7.1 国战相关

| 行为 | 获得荣誉值 |
|:----:|:----------:|
| 摧毁AGT (城门) | +700 |
| 摧毁CGT (城门) | +700 |
| 摧毁MS (法力石) | +500 |
| 摧毁DT (防御塔) | +500 |

### 7.2 其他途径

- 击杀敌国玩家
- 完成任务奖励
- 特殊活动奖励

---

## 八、相关数值汇总

| 参数 | 数值 | 说明 |
|:----:|:----:|:----:|
| 荣誉值上限 | 20000 | 最多能积累的荣誉值 |
| 每点物理伤害需要荣誉值 | 4000 | 荣誉值/4000=物理伤害加成 |
| 每点魔法伤害需要荣誉值 | 4000 | 荣誉值/4000=魔法伤害加成(25%触发) |
| 负荣誉值伤害系数 | 200 | \|负荣誉值\|/200=额外受到伤害 |
| 战争贡献值上限 | 1000000 | 与荣誉值是不同的系统 |

---

## 九、注意事项

1. **荣誉值** (`m_iContribution`) 和 **战争贡献值** (`m_iWarContribution`) 是两个不同的系统
2. 荣誉值可以为负数，负荣誉值会导致被攻击时受到额外伤害
3. 魔法伤害增益只有25%概率触发，物理伤害增益是100%触发
4. 职级称号只影响显示，实际增益按具体数值连续计算

---

*文档生成时间：2025年12月15日*
*代码版本：基于当前工作区代码分析*
